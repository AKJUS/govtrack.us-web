{% extends "master.html" %}
{% load humanize persontags video %}

{% block title %}{{person}} - GovTrack.us{% endblock %}

{% block meta_description %}
        {% if not active_role %}Former{% endif %}
        {{ role.get_role_type_display }}, {{ role.get_state_display }}
{% endblock %}

{% block extra_js %}
<script type='text/javascript' src='{{ MEDIA_URL }}jwplayer/jwplayer.js'></script>
<script type="text/javascript" src="{{ MEDIA_URL }}fancybox/jquery.fancybox-1.3.4.pack.js"></script>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ MEDIA_URL }}fancybox/jquery.fancybox-1.3.4.css" type="text/css" media="screen" />
{% endblock %}

{% block crumbs %}
{% comment %}Congress > Members of Congress{% endcomment %}
{% endblock %}

{% block body %}
<div class="person-details">
<div class="col_left">
    {% if photo %}
    <div class="photo">
        <img src="{{ photo }}" alt="Photo" style="border: 1px solid black" />
    </div>
    {% endif %}

	<div style="float: left; width: 410px">
    <h1>
    	{{ person.name_no_details }}
	    {% if role.website %}
		    <p><a href="{{ role.website }}" target="_blank"><tt>{{ role.website }}</tt></a></p>
	    {% endif %}
    </h1>
    </div>
    <div style="float: left; width: 400px; margin-top: 1em">
    {% if role %}
    <div class="role-details">
        {% if not active_role %}Former{% endif %}
        {{ role.get_role_type_display }} for
	   {{ role.get_state_display }}{% if role.district == 0 %}'s At-Large District {% endif %}{% if role.district > 0 %}'s {{role.district|ordinal}} District {% endif %}
	</div>
	<div class="role-details" style="font-style: italic">
	   {{ role.party }}
    </div>
    {% if role.district > 0 %}
    <p><a href="/congress/members/{{ role.state }}">district map</a></p>
    {% endif %}
    {% endif %}
    </div>

	<div class="clear"> </div>
    <h2>Elected Positions</h2>
    <table>
        <thead>
            <tr>
                <th>Dates</th>
                <th>Title</th>
                <th>Representing</th>
            </tr>
        </thead>
        {% for role in person.roles_condensed %}
        <tr>
            <td>{{ role.startdate|date:"Y" }}-{{ role.enddate|date:"Y" }}</td>
            <td>{{ role.get_role_type_display }}</td>
            <td>{{ role.get_state_display }}{% if role.district == 0 %}'s At-Large District {% endif %}{% if role.district > 0 %}'s {{role.district|ordinal}} District {% endif %}</td>
        </tr>
        {% endfor %}
    </table>
    {% if analysis_data %}
    <h2>Sponsorship Analysis</h2>
    <div class="analysis">
        {% if analysis_data.image %}
        <div class="graph">
            <img src="{{ analysis_data.image }}" />
        </div>
        {% endif %}
        <div class="details">
            {{ person.lastname }} is a {{ analysis_data.description }} according to GovTrack's own analysis of bill sponsorship. The graph to the left shows {{ person.lastname }} as a large dot among {{person|hisher}} peers, with the left-right axis indicating ideology and the up-down axis representing legislative leadership. <a href="#" onclick="$('#sponsorshipanalysis_info').slideDown(); $(this).fadeOut(); return false;">More...</a>

            <p id="sponsorshipanalysis_info" style="color: grey; display: none">These labels come from the <a href="#">Political Spectrum & Legislative Leadership statistical analysis</a> that we have carried out. The statistical analysis is blind to party affiliation and the content of bills. From there, we have divided the Members of Congress into far-left/right, rank-and-file, and centrist; and leader, rank-and-file, or lonely (i.e. follower) by 20<sup>th</sup> and 80<sup>th</sup> percentiles.</p>
        </div>
        <div class="clear"> </div>
	</div>
    {% endif %}
    
    <h2>Bills Sponsored...</h2>
    
    <h2>Recent Votes...</h2>
    
    {% if assignments %}
    <h2>Committee Assignments</h2>
    <a name="assignments"></a>
    <ul>
        {% for role in assignments %}
        <li class="committee-assignment">
            <div>
                {{ role.get_role_display }}, <a href="{{ role.committee.get_absolute_url }}">{{ role.committee }}</a>
                {% if role.subroles %}
                <div><a style="color: #666" href="#" onclick="$(this).hide(); $(this).parents('.committee-assignment').find('.subcommittee-assignment-list').show(); return false;">Show {{ role.subroles|length }} subcommittee assignment{{ role.subroles|pluralize }}</a></div>
                {% endif %}
            </div>
            {% if role.subroles %}
            <ul class="subcommittee-assignment-list" style="display: none">
                {% for subrole in role.subroles %}
                <li>
                {{ subrole.get_role_display }}, <a href="{{ subrole.committee.get_absolute_url }}">{{ subrole.committee }}</a>
                </li>
                {% endfor %}
            </ul>
            {% endif %}
        </li>
        {% endfor %}
    </ul>
    {% endif %}

</div>

<div class="col_right">
<div id="happening_now" class="sidebox" {% if not recent_video %}style="dispxlay: none"{% endif %}>
	<h2>Happening Now</h2>
    <div id="latest-tweet" style="display: none; margin-bottom: 1em">
		<a href="" class="tweetlink">
			<img src="http://twitter-badges.s3.amazonaws.com/t_logo-a.png" style="float: left; margin-right: 1em; margin-bottom: 1em" border="0" width="32" height="32"/>
		</a>
		<div style="float: left; width: 370px;">&ldquo;<span class="content"></span>&rdquo;</div>
		<div style="float: left; width: 370px;">&mdash; @<a class="twittername"></a> on <span class="twitterdate"></span></div>
		<div class="clear"> </div>
    </div>
    <script type="text/javascript">
        function renderLatestTweet(username) {
            var url = 'http://twitter.com/statuses/user_timeline/' + username + '.json';
            $.get(url, {count: 1}, function(data) {
                if (data.length) {
                    var tweet = data[0];
                    var created = new Date(tweet.created_at);
                    var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug',
                                  'Sep', 'Oct', 'Nov', 'Dec'];
                    var datestr = months[created.getMonth()] + '. ' + created.getDate() + ', ' + created.getFullYear();
                    var content = tweet.text;
                    $('#latest-tweet').show().find('.content').text(content).show();
					$('#latest-tweet').find('.twittername').text(username).show();
					$('#latest-tweet').find('.twittername, .tweetlink').attr('href', 'http://www.twitter.com/' + username)
					$('#latest-tweet').find('.twitterdate').text(datestr).show();
					$('#happening_now').show();
                }
            }, 'jsonp');
        }
        {% if person.twitterid %}
            renderLatestTweet('{{ person.twitterid }}');
        {% endif %}
    </script>
    {% if recent_video %}
        {% video recent_video %}
    {% endif %}
	<div class="clear"> </div>
</div>
<div class="sidebox">
	<h2>Media</h2>

	<div class="recent-video-list-container">
    <div class="recent-video-list">
    {% for video in videos %}
        {% video video %}
    {% endfor %}
    </div>
	</div>
    <div class="clear"></div>
</div>
<div class="sidebox">
	<h2>Tracked Events</h2>
	
	{% include "events/trackedeventspanel.html" %}
</div>
</div>

</div>

{% endblock %}

