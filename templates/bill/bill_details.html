{% extends "master_a.html" %}
{% load humanize %}
{% load cache %}

{% block title %}{{bill.title_no_number}} ({% if not bill.is_current %}{{bill.current_status_date|date:"Y"}}; {{bill.congress|ordinal}} Congress {% endif %}{{bill.display_number_no_congress_number}}) - GovTrack.us{% endblock %}

{% block meta_description %}{% if not bill.is_current %}{{bill.current_status_date}}. {% endif %}{{bill.display_number}}. {% if subtitle %}{{subtitle}}{% endif %} In GovTrack.us, a database of bills in the U.S. Congress.{% endblock %}
{% block meta_keywords %}U.S. Congress,Congress,legislation,bill{% for term in bill.terms.all %}{% if 10 > forloop.counter %},{{term}}{% endif %}{% endfor %},law{% endblock %}

{% block extra_js %}
{% endblock %}

{% block extra_css %}
<!-- bid:{{bill.id}} -->
<style>
#make_prediction {
	margin-top: 1em;
	margin-bottom: 1.2em;
	border-top: 1px dotted #AAA;
	border-bottom: 1px dotted #AAA;
	padding-top: 1em;
	padding-bottom: 0;
	line-height: normal;
	font-size: 85%;
	font-family: sans-serif;
}
.minor_vote {
	display: none;
}
</style>
{% endblock %}

{% block crumbs %}
<ul>
	<li><a href="{% url congress_home %}">Congress</a></li>
	<li><a href="/congress/bills">Bills</a></li>
	<li>{{bill.display_number}}</li>
</ul>
{% endblock %}

{% block body_class %}bill{% endblock %}

{% block summary %}

<div class="row">
	{% cache 600 billhead bill.id %}
	<h1>{{bill.title|truncatewords:15}}</h1>
		
	<div id="track_panel_base" class="{% if bill.is_alive %}eight{% else %}twelve{% endif %} columns">
		<div class="info" {% if not bill.is_alive %}style="width: auto;"{% endif %}>
			{% if bill.title != bill.title|truncatewords:15 %}
				{% with bill.title|truncatewords:15|cut:"..." as bt %}
					<p style="line-height: 130%">...{{bill.title|cut:bt}}</p>
				{% endwith %}
			{% endif %}
		
			<p class="date">{{bill.congress|ordinal}} Congress, {{congressdates.0|date:"Y"}}&ndash;{{congressdates.1|date:"Y"}}</p>
			
			{% if subtitle %}<p class="subtitle">{{subtitle}}</p>{% endif %}
			
			<dl>
				{% if not bill.is_alive %}
				<dt>Introduced:</dt>
				<dd>{{bill.introduced_date}}</dd>
				{% endif %}
			
				<dt>Sponsor:</dt>
				{% if bill.sponsor %}
					<dd><a class="name" href="{{bill.sponsor.get_absolute_url}}">{{sponsor_name}}</a></dd>
				{% else %}
					<dd>(bill introduced by rule or other special circumstance)</dd>
				{% endif %}
			
				<dt>Status:</dt>
				<dd>
				{% if not dead %}
					{{bill.get_current_status_display}}
				{% else %}
					Died ({{bill.get_current_status_display}})
				{% endif %}
				</dd>
				
				{% if bill.docs_house_gov_postdate and bill.docs_house_gov_postdate.date > bill.current_status_date %}
				<dt>Schedule:</dt>
				<dd>The House Majority Leader indicated on {{bill.docs_house_gov_postdate|date:"DATE_FORMAT"}} that this {{bill.noun}} may be considered in the week ahead.</dd>
				{% endif %}
				
				{% if bill.senate_floor_schedule_postdate and bill.senate_floor_schedule_postdate.date > bill.current_status_date %}
				<dt>Schedule:</dt>
				<dd>This {{bill.noun}} was added to the Senate&rsquo;s floor schedule for the next legislative day on {{bill.senate_floor_schedule_postdate|date:"DATE_FORMAT"}}.</dd>
				{% endif %}
				
				{% if bill.get_upcoming_meetings|length %}
				<dt>Schedule:</dt>
				<dd>
					<div>This {{bill.noun}} is scheduled for the following committee meetings:</div>
					{% for m in bill.get_upcoming_meetings %}
						<div>{{m.when}} &mdash; {{m.committee.fullname}}</div>
					{% endfor %}
				</dd>
				{% endif %}
			
				{% with reintros.1 as reintro_as %}
				{% if reintro_as %}
				<dt>See Instead:</dt>
				<dd>This bill was re-introduced as <a href="{{reintro_as.get_absolute_url}}">{{reintro_as.display_number}}</a> on {{reintro_as.introduced_date}}.
				{% if reintro_as.is_alive %}See <a href="{{reintro_as.get_absolute_url}}">{{reintro_as.display_number}}</a> for current action on this subject.{% endif %}</dd>
				{% endif %}
				{% endwith %}
			</dl>
		
		</div><!-- /info -->
		
		<p class="helptext" style="clear: both; line-height: 110%; margin: 0;"><small>The {{bill.noun}}&rsquo;s title {% if subtitle %}and summary above were{% else %}was{% endif %} written by the {{bill.noun}}&rsquo;s sponsor. {{bill.get_bill_type_display}} stands for {{bill.bill_type_name}}.</small></p>
	</div>
	{% endcache %}

	
	{% if bill.is_alive %}
	<div class="aside four columns">
		<a href="#" class="track-btn" onclick="return show_track_panel();">Track this bill</a>
		{% comment %}---- This cannot be cached!!!! ----{% endcomment %}
		{% include "events/subscribe_inline.html" %}
		
		<div style="margin: 1em 0">
			<a href="{{bill.get_absolute_url}}/advocacy" class="yellow-btn">Take a Position</a>
		</div>
		
		{% comment %}
		{% if market %}
		{% if not user.is_authenticated %}
		<div id="make_prediction">
		<p>{{market.name}} The community prediction is <b>{{market.yes_price}}%</b>. <a href="/accounts/login?next={{bill.get_absolute_url|urlencode}}">Log in</a> to make a bet.</p>
		</div>
		{% else %}
		<div id="make_prediction">
		<p>{{market.name}} The community prediction is <b>{{market.yes_price}}%</b>.</p>
		<p class="youthink" {% if market.user_positions %}style="display: none"{% endif %}>What do you think?</p>
		<p class="empty" {% if market.user_positions %}style="display: none"{% endif %}>
			1) <a href="#" prediction="-1">Worse Than {{market.yes_price}}%</a>.<br/>
			2) <a href="#" prediction="1">Better Than {{market.yes_price}}%</a>.
		</p>
		<p class="nonempty" {% if not market.user_positions %}style="display: none"{% endif %}>
			You bet on <span>{% if market.user_positions.1.shares > 0 %}yes{% else %}no{% endif %}</span>.
			{% if market.user_profit == 0 %}
				<a href="#" prediction="0">Clear bet</a>.
			{% endif %}
			{% if market.user_profit > 0 %}
				<a href="#" prediction="0">Cash out</a> for {{market.user_profit|floatformat:0}} points.
			{% endif %}
			{% if market.user_profit < 0 %}
				<a href="#" prediction="0">Take your loss</a> of {{market.user_profit|floatformat:0}} points before it gets worse.
			{% endif %}
		</p>
		</div>
		<script>
		$("#make_prediction a").click(function() {
			var p = this.getAttribute("prediction");
			$.ajax({
				url: "/congress/bills/_ajax/market_test_vote",
				type: "POST",
				data: {
					bill: {{bill.id}},
					prediction: p
				},
				dataType: "json",
				success: function(data) {
					if (data.vote == 0) {
						$("#make_prediction .empty").show();
						$("#make_prediction .nonempty").hide();
						$("#make_prediction .youthink").show();
					} else {
						$("#make_prediction .empty").hide();
						$("#make_prediction .nonempty").show();
						$("#make_prediction .nonempty span").text(data.vote == 1 ? "yes" : "no");
						$("#make_prediction .youthink").hide();
					}
				}
			});	
			return false;
		});
		</script>
		{% endif %}
		{% endif %}

		{% endcomment %}
		
		<div class="fb-like" data-send="false" data-layout="button_count" data-width="170" data-show-faces="false" style="margin-top: 10px"></div>
	</div><!-- /actions -->
	{% endif %}	
</div>
{% endblock %}

{% block body %}
{% cache 600 billoverview bill.id %}
<div id="bill-overview" class="section">
	
	<h2>{{bill.noun|capfirst}} Overview</h2>
		
	<div class="overview six columns">
		<div class="holder">
			<div class="frame">
				
				<div class="container">
					<dl>
						<dt>Status:</dt>
						<dd>
							<table>
								{% for item in bill.get_major_events %}
								<tr>
									<td class="done" title="{{item.extra}}">{{item.label}}</td>
									<td>{{item.date|date:"DATE_FORMAT"}}</td>
								</tr>
								{% endfor %}
							
								{% if current %}
								{% for item in bill.get_future_events %}
								<tr>
									<td class="pending">{{item}}</td>
									<td>(not yet occurred)</td>
								</tr>
								{% endfor %}
								{% endif %}
								
								<tr><td colspan="2" style="padding-top: 5px; line-height: normal;">
								{% if not died %}
									{{bill.current_status_description}}
								{% else %}
									This {{bill.noun}} died in a previous session of Congress.
								{% endif %}
								</td></tr>
							</table>

						</dd>
						
						{% if bill.votes.exists %}
							<dt>Votes:</dt>
							<dd>
								{% for v in bill.votes.all %}
								<p class="{% if v.is_major %}major_{% else %}minor_{% endif %}vote">
									<a href="{{v.get_absolute_url}}">
										{% if v.is_major %}
											{{v.get_chamber_display}}: {{v.vote_type}}
										{% else %}
											{{v}}
										{% endif %}
									</a><br/>
									{{v.created}}<br/>
									{{v.summary}}</p>
								{% endfor %}
								<p id="more_votes" style="display: none; font-style: italic;"><a href="#" onclick="return show_all_votes();">Show <span class='num'> </span> <span class='desc'> </span> votes...</a><p>
								<p id="fewer_votes" style="display: none"><a href="#" onclick="return hide_minor_votes();">Hide minor votes...</a><p>
							</dd>
							<script>
								var minor_votes = $('.minor_vote');
								if (minor_votes.length > 0) {
									$('#more_votes').show();
									$('#more_votes').find('span.num').text(minor_votes.length);
									$('#more_votes').find('span.desc').text($('.major_vote').length == 0 ? "" : "additional");
								}
								function show_all_votes() {
									$('.minor_vote').fadeIn();
									$('#more_votes').hide();
									$('#fewer_votes').show();
									return false;
								}
								function hide_minor_votes() {
									$('.minor_vote').fadeOut();
									$('#more_votes').show();
									$('#fewer_votes').hide();
									return false;
								}
							</script>
						{% endif %}
				
						{% with bill.get_prognosis as p %}
						{% if p %}
						<dt>Prognosis:</dt>
						<dd>
							{% if p.is_introduced %}
								<p><b>
								{{p.prediction_1|floatformat:0}}%</b> chance of getting past committee.<br/>
								<b>{{p.prediction|floatformat:0}}%</b> chance of being {{p.success_name}}.</p>
								<p class="prognosis_item">{% if 40 > p.success_rate_1 %}Only {% endif %}{{p.success_rate_1|floatformat:0}}% of {{bill.bill_type_name_short}}s made it past committee
								and {% if 40 > p.success_rate %}only {% endif %} {{p.success_rate|floatformat:0}}% were {{p.success_name_2}}
								in {{p.congressdates.0|date:"Y"}}&ndash;{{p.congressdates.1|date:"Y"}}.
							{% else %}
								<p><b>{{p.prediction|floatformat:0}}%</b> chance of being {{p.success_name}}.</p>
								<p class="prognosis_item">{% if 40 > p.success_rate_2 %}Only {% endif %}{{p.success_rate_2|floatformat:0}}% of {{bill.bill_type_name_short}}s that made it past committee in {{p.congressdates.0|date:"Y"}}&ndash;{{p.congressdates.1|date:"Y"}} were {{p.success_name_2}}.
							{% endif %}
							{% if p.factors_help_help or p.factors_hurt_hurt or p.factors_help_hurt or p.factors_hurt_help %}<a href="#" onclick="$('#prognosis_factors').slideToggle(); return false;">show factors</a>{% endif %}
							</small></p>
							
							<div id="prognosis_factors" style="display: none">
							{% if p.factors_help_help %}
							<p>The following factors helped this {{bill.noun}}:</p>
							{% for factor in p.factors_help_help %}
								<p class="prognosis_item">{{factor}}</p>
							{% endfor %}
							{% endif %}
							
							{% if p.factors_hurt_hurt %}
							<p>The following factors hurt this {{bill.noun}}:</p>
							{% for factor in p.factors_hurt_hurt %}
								<p class="prognosis_item">{{factor}}</p>
							{% endfor %}
							{% endif %}
							
							{% if p.factors_help_hurt %}
							<p>The following factors help this {{bill.noun}} get past committee but hurt it on the floor:</p>
							{% for factor in p.factors_help_hurt %}
								<p class="prognosis_item">{{factor}}</p>
							{% endfor %}
							{% endif %}
							
							{% if p.factors_hurt_help %}
							<p>The following factors hurt this {{bill.noun}} in getting past committee but help it on the floor:</p>
							{% for factor in p.factors_hurt_help %}
								<p class="prognosis_item">{{factor}}</p>
							{% endfor %}
							{% endif %}
							</div>
						</dd>
						{% endif %}
						{% endwith %}
				
					</dl>
				</div><!-- /container -->
				
				<div class="container">
					<dl>
						<dt>Text:</dt>
						<dd>
							<ul class="text-view">
								<!--<li><a href="#">Summary</a></li>-->
								<li><a href="{{bill.get_absolute_url}}/text">Read {{bill.noun|capfirst}} Text</a></li>
							</ul>
						</dd>
					</dl>
				</div><!-- /container -->
				
				<div class="container">
					<dl class="heading">
						<dt>Cosponsors:</dt>
						<dd>
							{% if bill.cosponsors.all|length == 0 %}
								none
							{% else %}
								<a href="#" onclick="if (!$('#cosponsors').is(':visible')) $('#cosponsors').slideDown(); else $('#cosponsors').slideUp(); return false;">show cosponsors ({{bill.cosponsor_count}})</a>
								<div id="cosponsors" style="display: none">
									{% for cosp in bill.cosponsor_records %}
									<div><a href="{{cosp.person.get_absolute_url}}">{{cosp.person_name}}</a></div>
									{% if cosp.joined != bill.introduced_date %}
										<div style="margin-left: 1.5em; font-size: 85%">(joined {{cosp.joined}}{% if cosp.withdrawn %}; withdrawn {{cosp.withdrawn}}{% endif %})</div>
									{% else %}
										{% if cosp.withdrawn %} 
											<div style="margin-left: 1.5em; font-size: 85%">(withdrawn {{cosp.withdrawn}})</div>
										{% endif %}
									{% endif %}
									{% endfor %}
								</div>
							{% endif %}
						</dd>
						</dl>

					{% if bill.committees.exists %}
					<dl class="heading">
						<dt>Committees:</dt>
						<dd>
							{% for c in bill.committees.all %}
								{% if not c.committee %}
									<p><a href="{{c.get_absolute_url}}">{{c}}</a></p>
									{% for s in bill.committees.all %}
										{% if s.committee == c %}
											<p style="margin-left: 2em"><a href="{{s.get_absolute_url}}">{{s}}</a></p>
										{% endif %}
									{% endfor %}
								{% endif %}
							{% endfor %}
							<p>The committee chair determines whether a {{bill.noun}} will move past the committee stage.</p>
						</dd>
					</dl>
					{% endif %}
					</div> <!-- ?? -->
				</dv> <!-- /container -->

				<div class="container">
					<dl>
						<dt>Primary Source</dt>
						<dd>
							<p><a href="{{bill.thomas_link}}">THOMAS (The Library of Congress)</a><br/>THOMAS is updated generally one day after events occur and events since the last update may not be reflected here.</p>
						</dd>
						<dt>Citation</dt>
						<dd>
							<script>function show_cite(fmt) {
								var v = $("#cite_" + fmt).is(":visible");
								$('#cite_apa, #cite_mla, #cite_wikipedia').slideUp();
								if (!v) $("#cite_" + fmt).slideDown();
								return false;
							}</script>
							<p>This page can be cited in one of these formats (click for details):
								<a href="#" onclick="return show_cite('apa')">APA</a>,
								<a href="#" onclick="return show_cite('mla')">MLA</a>,
								<a href="#" onclick="return show_cite('wikipedia')">Wikipedia Template</a>.
							</p>
							<p id="cite_apa" style="display: none">{{bill.display_number_no_congress_number}}--{{bill.congress|ordinal}} Congress: {{bill.title_no_number}}. ({{bill.introduced_date|date:"Y"}}). In GovTrack.us (database of federal legislation). Retrieved {% now "F j, Y" %}, from {{request.build_absolute_uri}}</p>

							<p id="cite_mla" style="display: none">&ldquo;{{bill.display_number_no_congress_number}}--{{bill.congress|ordinal}} Congress: {{bill.title_no_number}}.&rdquo; GovTrack.us (database of federal legislation). {{bill.introduced_date|date:"Y"}}. {% now "F j, Y" %} &lt;{{request.build_absolute_uri}}&gt;</p>

							<p id="cite_wikipedia" style="display: none">{{cite web<br/>
							|url={{request.build_absolute_uri}}<br/>
							|title={{bill.display_number_with_congress_number}}<br/>
							|accessdate={% now "F j, Y" %}<br/>
							|author={{bill.congress|ordinal}} Congress ({{bill.introduced_date|date:"Y"}})<br/>
							|date={{bill.introduced_date|date:"F j, Y"}}<br/>
							|work=Legislation<br/>
							|publisher=GovTrack.us<br/>
							|quote={{bill.title_no_number}}<br/>
							}}</p>
						</dd>
					</dl>
				</div>				
			</div><!-- /frame -->
		</div><!-- /holder -->
	</div><!-- /overview -->
	
	<div class="six columns">
	<div class="overview">
		<div class="holder">
			<div class="frame">
				
			
				{% with bill.get_approved_links as links %}
				{% if links|length > 0 %}
				<div class="container">
					<dl style="margin-top: 1em">
						<dt>News Sites &amp; Links:</dt>
						<dd>
							{% for link in links %}
								<div style="margin-bottom: .5em">
									<div><a href="{{link.url}}" target="_blank" rel="nofollow">{{link.title}}</a></div>
									<div><small>{{link.created|date}} &mdash; {{link.hostname}}</small></div>
								</div>
							{% endfor %}
						</dd>
					</dl>
				</div>
				{% endif %}
				{% endwith %}
			
				{% with reintros.0 as reintro_from %}
				<div class="container">
					<dl style="margin-top: 1em">
						<dt>Related Bills:</dt>
						<dd>
							{% if bill.relatedbills.exists %}
							<div>
							{% for rb in bill.get_related_bills %}
								<div style="margin-bottom: .25em">{% if rb.relation != "unknown" %}{{rb.relation}}: {% endif %}<a href="{{rb.related_bill.get_absolute_url}}">{{rb.related_bill}}</a></div>
							{% endfor %}
							</div>
							<p><small>Related bills above are identified by the Congressional Research Service.</small></p>
							{% endif %}
							
							{% if reintro_from %}
							<p>This bill was a re-introduction of <a href="{{reintro_from.get_absolute_url}}">{{reintro_from.display_number}}</a> ({{reintro_from.introduced_date}}).</p>
							{% endif %}
							
							<p>Search for <a href="/congress/bills/browse?congress={{bill.congress}}#similar_to={{bill.get_bill_type_display}}{{bill.number}}/{{bill.congress}}">similar bills</a>.</p>
						</dd>
					</dl>
				</div>
				{% endwith %}
					
				{% if bill.terms.exists %}
				<div class="container">
					<dl style="margin-top: 1em">
						<dt>Subject Areas:</dt>
						<dd>
							<p>Use these subject areas to explore related legislation:</p>
							<div>
							{% for term in bill.get_terms_sorted %}
								<div><a {% if term.is_top_term %}style="font-weight: bold"{% endif %} href="{{term.get_absolute_url}}?congress={{bill.congress}}">{{term}}</a></div>
							{% endfor %}
							</div>
						</dd>
					</dl>
				</div>
				{% endif %}
		
			</div>
		</div>
	</div><!-- /overview -->
		
		{% if bill.terms.exists %}
		<div style="padding-top: 30px; width: 340px; margin: 0 auto;">
		<script type="text/javascript"><!--
		google_ad_client = "ca-pub-3418906291605762";
		/* GT Secondary */
		google_ad_slot = "8748660262";
		google_ad_width = 336;
		google_ad_height = 280;
		//-->
		</script>
		<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"> </script>		
		</div>
		{% endif %}
	</div> <!-- six cols -->
	
	{% with bill.get_formatted_summary as summary %}
	{% if summary %}
	<section class="clear" style="padding-top: 2em">
		<h3 style="margin-bottom: 1em">Official Summary</h3>
		<p style="font-style: italic">This summary was written by the Congressional Research Service, a nonpartisan arm of the Library of Congress. GovTrack did not write and has no control over these summaries.</p>
		{{summary|safe}}
	</section>
	{% endif %}
	{% endwith %}
</div><!-- /container -->

{% endcache %}
{% endblock %}
